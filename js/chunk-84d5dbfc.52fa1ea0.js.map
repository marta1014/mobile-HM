{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.object.values.js","webpack:///./src/views/login/index.vue?c87e","webpack:///./node_modules/core-js/internals/object-to-array.js","webpack:///./src/views/login/index.vue?b380","webpack:///src/views/login/index.vue","webpack:///./src/views/login/index.vue?e0c5","webpack:///./src/views/login/index.vue","webpack:///./src/api/user.js"],"names":["$","$values","values","target","stat","O","DESCRIPTORS","objectKeys","toIndexedObject","propertyIsEnumerable","f","createMethod","TO_ENTRIES","it","key","keys","length","i","result","call","push","module","exports","entries","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","ref","model","value","user","callback","$$v","$set","expression","on","$event","countdownShow","slot","onSendSmsCode","_v","onLogin","staticRenderFns","name","data","mobile","code","methods","component","login","request","url","method","getSmsCode","getUserinfo","getChannels","getUserProfile","updateUserProfile","updateUserPhoto"],"mappings":"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","file":"js/chunk-84d5dbfc.52fa1ea0.js","sourcesContent":["var $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.github.io/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=151cafb7&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=151cafb7&lang=less&scoped=true&\"","var DESCRIPTORS = require('../internals/descriptors');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable.call(O, key)) {\n        result.push(TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.github.io/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.github.io/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"loginPage\"},[_c('van-nav-bar',{attrs:{\"title\":\"登陆\"}}),_c('ValidationObserver',{ref:\"form\"},[_c('ValidationProvider',{attrs:{\"name\":\"手机号\",\"rules\":\"required|mobile\"}},[_c('van-field',{attrs:{\"required\":\"\",\"label\":\"手机号\",\"placeholder\":\"请输入用户名\"},model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}})],1),_c('ValidationProvider',{attrs:{\"name\":\"验证码\",\"rules\":\"required|code\"}},[_c('van-field',{attrs:{\"required\":\"\",\"label\":\"验证码\",\"placeholder\":\"请输入验证码\"},model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}},[(_vm.countdownShow)?_c('van-count-down',{attrs:{\"slot\":\"button\",\"format\":\"ss s\",\"time\":1000*60},on:{\"finish\":function($event){_vm.countdownShow = false}},slot:\"button\"}):_c('van-button',{attrs:{\"slot\":\"button\",\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.onSendSmsCode},slot:\"button\"},[_vm._v(\"发送验证码\")])],1)],1)],1),_c('van-cell',[_c('van-button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.onLogin}},[_vm._v(\"登陆\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"loginPage\">\n    <van-nav-bar title=\"登陆\" />\n    <ValidationObserver ref=\"form\">\n    <ValidationProvider\n    name=\"手机号\"\n    rules=\"required|mobile\"\n    >\n      <van-field\n      required\n      v-model=\"user.mobile\"\n      label=\"手机号\"\n      placeholder=\"请输入用户名\" />\n      <!-- {{errors[0]}} -->\n    </ValidationProvider>\n    <ValidationProvider\n    name=\"验证码\"\n    rules=\"required|code\"\n    >\n      <van-field\n      required\n      v-model=\"user.code\"\n      label=\"验证码\"\n      placeholder=\"请输入验证码\">\n        <van-count-down\n        slot=\"button\"\n        format=\"ss s\"\n        v-if=\"countdownShow\"\n        @finish=\"countdownShow = false\"\n        :time=\"1000*60\" />\n        <van-button\n        v-else\n        slot=\"button\"\n        size=\"small\"\n        @click=\"onSendSmsCode\"\n        type=\"primary\">发送验证码</van-button>\n      </van-field>\n    </ValidationProvider>\n    </ValidationObserver>\n    <van-cell>\n        <van-button type=\"info\"\n        @click=\"onLogin\"\n        >登陆</van-button>\n    </van-cell>\n    </div>\n</template>\n\n<script>\nimport { login, getSmsCode } from '@/api/user'\nimport { validate } from 'vee-validate'\n// 此方法专门用来验证某个字段 与this.$refs.form.validate()不是一回事\nexport default {\n  name: 'loginPage',\n  data () {\n    return {\n      user: {\n        mobile: '13911111111',\n        code: '246810'\n      },\n      countdownShow: false\n    }\n  },\n  methods: {\n    async onLogin () {\n      const user = this.user\n      const success = await this.$refs.form.validate()\n      if (!success) { // 验证失败 提示并return\n        setTimeout(() => {\n          const { errors } = this.$refs.form\n          //   console.log(errors, '失败')\n          // 获取错误对象 => 对象.values得到数组 => 遍历/return 第一个错误 => 轻提示文本\n          // const item = Object.values(errors).find(item => { return item[0] })\n          const item = Object.values(errors).find(item => item[0])\n          this.$toast(item[0])\n        }, 100)\n        return\n      }\n      this.$toast.loading({\n        duration: 0, // 持续展示 toast\n        message: '加载中...',\n        forbidClick: true // 是否禁止背景点击\n      })\n      try {\n        this.$toast.success('登陆成功')\n\n        // 有来源页跳至来源页否则跳至登陆页\n        const redirect = this.$route.query.redirect || '/'\n        this.$router.push(redirect)\n        const res = await login(user)\n        // console.log(res)\n        // 将登陆状态存储vuex容器中\n        this.$store.commit('setUser', res.data.data)\n      } catch (error) {\n        this.$toast.fail('登陆失败')\n        this.countdownShow = false\n        // console.log(error)\n      }\n    },\n    async onSendSmsCode () {\n      const { mobile } = this.user\n      let res = await validate(mobile, 'required|mobile', { name: '手机号' })\n      // console.log(res)\n      if (!res.valid) {\n        // 提示 return\n        this.$toast(res.errors[0])\n        return\n      }\n      try {\n        this.countdownShow = true\n        await getSmsCode(mobile)\n      } catch (error) {\n        // console.log(error)\n        this.countdownShow = false\n        if (error.response.status === 429) {\n          this.$toast('请勿频繁发送')\n        }\n        this.$toast.fail('发送失败')\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.loginPage{\n    .van-cell{\n        padding: 26px 16px;\n        .van-button{\n            width: 100%;\n    }\n    }\n\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=151cafb7&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=151cafb7&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"151cafb7\",\n  null\n  \n)\n\nexport default component.exports","// 用户相关请求\n\nimport request from '@/utils/request'\n\n// export const login = data => {\n//   return request({\n//     url: '/app/v1_0/authorizations',\n//     method: 'post',\n//     // params: {},query参数\n//     // headers: {},请求头参数\n//     //data  body参数\n//   })\n// }\nexport const login = data => request({// 登录\n  url: '/app/v1_0/authorizations',\n  method: 'post',\n  data\n})\n\nexport const getSmsCode = mobile => { // 获取验证码\n  return request({\n    method: 'GET',\n    url: `/app/v1_0/sms/codes/${mobile}`\n  })\n}\n// 获取用户个人信息\nexport const getUserinfo = () => request({ url: `/app/v1_0/user` })\n\n// 获取频道列表 用户/推荐\nexport const getChannels = () => request({ url: `/app/v1_0/user/channels` })\n\n// 获取用户个人资料\nexport const getUserProfile = () => request({ url: `/app/v1_0/user/profile` })\n\n// 更新用户资料\nexport const updateUserProfile = data => request({\n  method: 'PATCH',\n  url: '/app/v1_0/user/profile',\n  data\n})\n// 编辑用户头像\nexport const updateUserPhoto = data => request({\n  method: 'PATCH',\n  url: '/app/v1_0/user/photo',\n  data\n})\n"],"sourceRoot":""}